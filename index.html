
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Quickstart &mdash; Abrupt v0.2 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Abrupt v0.2 documentation" href="#" />
    <link rel="next" title="abrupt.http - HTTP base classes" href="http.html" /> 
  </head>
  <body>
<pre class="header_logo">
   _   _                  _   
  /_\ | |__ _ _ _  _ _ __| |_ 
 / _ \| '_ \ '_| || | '_ \  _|
/_/ \_\_.__/_|  \_,_| .__/\__|
                 0.2|_|       
</pre>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="http.html" title="abrupt.http - HTTP base classes"
             accesskey="N">next</a> |</li>
        <li><a href="#">Abrupt v0.2 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
          <div class="body">
            
  <p>Web Application Penetration Framework.
BSD Licensed. Based on Python&gt;=2.6.</p>
<div class="section" id="quickstart">
<h1>Quickstart<a class="headerlink" href="#quickstart" title="Permalink to this headline">¶</a></h1>
<div class="highlight-python"><pre>$ sudo pip install abrupt
$ abrupt
Generating SSL certificate...
CA certificate : /home/tweksteen/.abrupt/ca.pem
Abrupt v0.2
&gt;&gt;&gt;</pre>
</div>
<p>The first time you start Abrupt, it will generate a CA certificate. This is
useful to avoid the exception creation whenever you reach a HTTPS site with the
proxy enabled. You can install this certificate in your browser. However, no
check is performed by Abrupt on the server side regarding ssl.</p>
<div class="section" id="proxy">
<h2>Proxy<a class="headerlink" href="#proxy" title="Permalink to this headline">¶</a></h2>
<p>To start, let&#8217;s grab some HTTP requests. To do so, use the proxy or <a class="reference internal" href="proxy.html#p" title="p"><tt class="xref py py-func docutils literal"><span class="pre">p()</span></tt></a> function. It
starts a new proxy server on port 8080. This server will catch every HTTP(S)
request and prompt the user for directions:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">()</span>
<span class="go">Running on port 8080</span>
<span class="go">Ctrl-C to interrupt the proxy...</span>
</pre></div>
</div>
<p>You can now configure your browser to use <a class="reference external" href="http://localhost:8080">http://localhost:8080</a> as your proxy.
All the requests will be captured by Abrupt:</p>
<div class="highlight-python"><pre>&lt;GET www.phrack.org /&gt; ?</pre>
</div>
<p>For each request, you can decide what to do:</p>
<blockquote>
<div><ul class="simple">
<li>(v)iew - print the full request</li>
<li>(e)dit - manually edit the request in your favorite $EDITOR</li>
<li>(d)rop - drop the request</li>
<li>(f)orward - Forward the request</li>
<li>(c)ontinue - Forward this request and the following</li>
</ul>
</div></blockquote>
<p>Forward is the default action if none is passed. Once a request has been made,
you can see the response status and length:</p>
<div class="highlight-python"><pre>&lt;GET www.phrack.org /&gt; ? f
&lt;200 Gzip 5419&gt;</pre>
</div>
<p>Once you&#8217;re done with your requests, use Ctrl-C to exit. This function return
all the completed requests and associated responses in a <a class="reference internal" href="http.html#RequestSet" title="RequestSet"><tt class="xref py py-class docutils literal"><span class="pre">RequestSet</span></tt></a> object:</p>
<div class="highlight-python"><pre>1 request intercepted
{200:1 | www.phrack.org}
&gt;&gt;&gt; requests = _
&gt;&gt;&gt; print requests
Method Path Query Status Length
GET    /          200    5419

&gt;&gt;&gt; requests[0]
&lt;GET www.phrack.org /&gt;</pre>
</div>
<p>Not all the requests are shown. By default, a filter silently forward all the
image files (.png, .jpg, .jpeg, .ico, .gif). To see them, you can use:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">(</span><span class="nb">filter</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</pre></div>
</div>
<p>Some other functions exists : <em>w</em>, just display the requests, doesn&#8217;t provided
any interaction. <em>p1</em> and <em>w1</em>, working as <em>p</em> and <em>w</em> but only intercept one
request.</p>
</div>
<div class="section" id="request-and-response">
<h2>Request and Response<a class="headerlink" href="#request-and-response" title="Permalink to this headline">¶</a></h2>
<p>Abrupt have its own representation of HTTP request and response:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">r</span>
<span class="go">GET / HTTP/1.1</span>
<span class="go">Accept-Language: en-us,en;q=0.5</span>
<span class="go">Accept-Encoding: gzip,deflate</span>
<span class="go">Keep-Alive: 115</span>
<span class="go">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span>
<span class="go">User-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.2.15)</span>
<span class="go">Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7</span>
<span class="go">Host: www.phrack.org</span>
<span class="go">Proxy-Connection: keep-alive</span>
</pre></div>
</div>
<p><a class="reference internal" href="http.html#Request" title="Request"><tt class="xref py py-class docutils literal"><span class="pre">Request</span></tt></a> objects have numerous attributes: hostname, port, headers,
path, query, url, content. You can edit the request through your EDITOR
(default is vim) to create a new request:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">new_r</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">edit</span><span class="p">()</span>
</pre></div>
</div>
<p>And execute the new request:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">new_r</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_r</span><span class="o">.</span><span class="n">response</span>
<span class="go">&lt;200 Gzip 5419&gt;</span>
</pre></div>
</div>
<p>For more fun, try the <a class="reference internal" href="http.html#Request.play" title="Request.play"><tt class="xref py py-meth docutils literal"><span class="pre">Request.play()</span></tt></a>!</p>
<p><a class="reference internal" href="http.html#Response" title="Response"><tt class="xref py py-class docutils literal"><span class="pre">Response</span></tt></a> objects have the attributes: status, reason, headers, content,
readable_content. You can use the <em>preview</em> method to open a static dump of
the response in your favorite BROWSER and the <em>view</em> method to view the source
in your favorite EDITOR.</p>
</div>
<div class="section" id="requestset">
<h2>RequestSet<a class="headerlink" href="#requestset" title="Permalink to this headline">¶</a></h2>
<p>A <a class="reference internal" href="http.html#RequestSet" title="RequestSet"><tt class="xref py py-class docutils literal"><span class="pre">RequestSet</span></tt></a> is just a set of requests. Usually, you&#8217;ll have one from a proxy
method. You can add more requests from another capture session:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="p">()</span>
<span class="go">Ctrl-C to interrupt the proxy...</span>
<span class="go">&lt;GET www.cryptome.org /&gt;</span>
<span class="go">&lt;200 49380&gt;</span>
<span class="go">1 request intercepted</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">requests</span> <span class="o">+=</span> <span class="n">_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">requests</span>
<span class="go">{200:2 | phrack.org, www.cryptome.org}</span>
</pre></div>
</div>
<p>You can filter the request by any request attributes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">requests</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">hostname</span><span class="o">=</span><span class="s">&quot;phrack.org&quot;</span><span class="p">)</span>
<span class="go">{200:1 | phrack.org}</span>
</pre></div>
</div>
</div>
<div class="section" id="injection">
<h2>Injection<a class="headerlink" href="#injection" title="Permalink to this headline">¶</a></h2>
<p>From one request, it is possible to generate a batch of request where one or
many parameters change using the injection or <a class="reference internal" href="injection.html#i" title="i"><tt class="xref py py-func docutils literal"><span class="pre">i()</span></tt></a> function</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span>
<span class="go">&lt;GET phrack.org /issues.html&gt;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="n">i</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">issue</span><span class="o">=</span><span class="s">&quot;default&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span>
<span class="go">{unknown:9 | phrack.org}</span>
</pre></div>
</div>
<p>In this case, a RequestSet of 9 requests has been generated. <em>i</em> lookup for
arguments in the query string, the cookie and the post data. You should give
the name and the list of payloads name as arguments. The list of payloads can
be found in the payloads/ directory. You can also get the keys of the <a class="reference internal" href="injection.html#payloads" title="payloads"><tt class="xref py py-data docutils literal"><span class="pre">payloads</span></tt></a>
global variable. Before being injected, each payload is pass through the
<em>pre_func</em> function which is, by default, <a class="reference internal" href="injection.html#e" title="e"><tt class="xref py py-func docutils literal"><span class="pre">e()</span></tt></a>.</p>
<p>Once the requests have been generated, you can send them:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span><span class="p">()</span>
<span class="go">Running 9 requests...done.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span>
<span class="go">{200:9 | phrack.org}</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">batch</span>
<span class="go">Id Method Path         Query                          Status Length</span>
<span class="go">0  GET    /issues.html issue=%27                      200    2390</span>
<span class="go">1  GET    /issues.html issue=abrupt_xss__             200    2390</span>
<span class="go">2  GET    /issues.html issue=%3C%2Fabrupt%3E          200    2390</span>
<span class="go">3  GET    /issues.html issue=%29%29%29%29%29%29%29... 200    2390</span>
<span class="go">4  GET    /issues.html issue=..%2F..%2F..%2F..%2F.... 200    2390</span>
<span class="go">5  GET    /issues.html issue=..%5C..%5C..%5C..%5C.... 200    2390</span>
<span class="go">6  GET    /issues.html issue=%7C%7C+ping+-i+60+127... 200    2390</span>
<span class="go">7  GET    /issues.html issue=%3Bid                    200    2390</span>
<span class="go">8  GET    /issues.html issue=%3Becho+123456           200    2390</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="reference">
<h1>Reference<a class="headerlink" href="#reference" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="http.html">abrupt.http - HTTP base classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="proxy.html">abrupt.proxy - HTTP(S) Proxy</a></li>
<li class="toctree-l1"><a class="reference internal" href="injection.html">abrupt.injection - Request generator</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">abrupt.history - Global history</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">abrupt.conf - Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="real-world.html">Real World Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="real-world.html#csrf-protected-form">CSRF Protected Form</a></li>
<li class="toctree-l2"><a class="reference internal" href="real-world.html#blind-sql-injection">Blind SQL Injection</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cheatsheet.html">CheatSheet</a><ul>
<li class="toctree-l2"><a class="reference internal" href="cheatsheet.html#function">Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="cheatsheet.html#global">Global</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><em>Index</em></a></li>
<li><a class="reference internal" href="search.html"><em>Search Page</em></a></li>
</ul>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="http.html" title="abrupt.http - HTTP base classes"
             >next</a> |</li>
        <li><a href="#">Abrupt v0.2 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Securus Global.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>