
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>abrupt.injection - Request generator &mdash; Abrupt 0.5 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Abrupt 0.5 documentation" href="index.html" />
    <link rel="next" title="abrupt.session - Session handler" href="session.html" />
    <link rel="prev" title="abrupt.proxy - HTTP(S) Proxy" href="proxy.html" /> 
  </head>
  <body>
<pre class="header_logo">
   _   _                  _   
  /_\ | |__ _ _ _  _ _ __| |_ 
 / _ \| '_ \ '_| || | '_ \  _|
/_/ \_\_.__/_|  \_,_| .__/\__|
                    |_|       
</pre>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="session.html" title="abrupt.session - Session handler"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="proxy.html" title="abrupt.proxy - HTTP(S) Proxy"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Abrupt 0.5 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
          <div class="body">
            
  <div class="section" id="module-injection">
<span id="abrupt-injection-request-generator"></span><h1>abrupt.injection - Request generator<a class="headerlink" href="#module-injection" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="injection.inject">
<tt class="descclassname">injection.</tt><tt class="descname">inject</tt><big>(</big><em>request</em>, <em>to=None</em>, <em>at=None</em>, <em>payload=&quot;default&quot;</em><big>)</big><a class="headerlink" href="#injection.inject" title="Permalink to this definition">¶</a></dt>
<dd><p>aliased <cite>i</cite></p>
<p>This function will create a RequestSet from a Request where a part
of the latter is replaced with some payload. There is two way to use
this function, either to inject the value of a parameter or to inject
at a specific location.</p>
<p>When used with the <cite>to</cite> parameter, Abrupt will look up the value
in the query string, the request content and the cookies. It will
then replace the value of the parameter with the payloads. If no
valid injection point is found, an error is raised.</p>
<p>When used with the <cite>at</cite> parameter, Abrupt will look up the string in the
whole request text and replace it with the payloads. If no valid injection
point is found, an error is raised. If the string is found more than
once, the function will suggest to provide the &#8216;choice&#8217; integer keyword.</p>
<p>In both case, the <cite>to</cite> or <cite>at</cite> parameter can be a list. The same logic
described above will then be applied for each element of that list.</p>
<p><cite>payload</cite> could either be a list of the payloads to inject or a key
of the global dictionary <a class="reference internal" href="#injection.payloads" title="injection.payloads"><tt class="xref py py-data docutils literal"><span class="pre">payloads</span></tt></a>.</p>
<p>Some examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">r</span>
<span class="go">GET /issues.html?issue=59&amp;id=5 HTTP/1.1</span>
<span class="go">Host: www.phrack.com</span>
<span class="go">Cookie: PHPSESSID=4592a21fc9fd6b1e0afcc931eb74b28a</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="s">&quot;id&quot;</span><span class="p">)</span>
<span class="go">{unknown:188 | www.phrack.com}</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="s">&quot;PHPSESSID&quot;</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;1234&quot;</span><span class="p">,</span><span class="s">&quot;0000&quot;</span><span class="p">,</span><span class="s">&quot;31337-abcd&quot;</span><span class="p">])</span>
<span class="go">{unknown:3 | www.phrack.com}</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="s">&quot;issue&quot;</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="s">&quot;sqli&quot;</span><span class="p">)</span>
<span class="go">{unknown:106 | www.phrack.com}</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">at</span><span class="o">=</span><span class="s">&quot;4592a21fc9fd6b1e0afcc931eb74b28a&quot;</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="s">&quot;sqli&quot;</span><span class="p">)</span>
<span class="go">{unknown:106 | www.phrack.com}</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;issue&quot;</span><span class="p">,</span> <span class="s">&quot;id&quot;</span><span class="p">])</span>
<span class="go">{unknown:376 | www.phrack.com}</span>
</pre></div>
</div>
<p>The <cite>pre_func</cite> parameter is a function to apply to each payload before
being injected. By default, it urlencodes the payload.</p>
</dd></dl>

<dl class="function">
<dt id="injection.find_injection_point">
<tt class="descclassname">injection.</tt><tt class="descname">find_injection_point</tt><big>(</big><em>request</em><big>)</big><a class="headerlink" href="#injection.find_injection_point" title="Permalink to this definition">¶</a></dt>
<dd><p>alias <cite>fip</cite></p>
<p>This function returns a list of all the injection point found by Abrupt.
It can be used to inject only on a subset of them:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">fip</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="go">[&#39;issue&#39;, &#39;id&#39;, &#39;PHPSESSID&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="n">fip</span><span class="p">(</span><span class="n">r</span><span class="p">)[:</span><span class="mi">2</span><span class="p">])</span>
<span class="go">{unknown:212 | www.phrack.com}</span>
</pre></div>
</div>
</dd></dl>

<dl class="data">
<dt id="injection.payloads">
<tt class="descclassname">injection.</tt><tt class="descname">payloads</tt><a class="headerlink" href="#injection.payloads" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary containing all the payloads. Each value is a list of
string. When started, Abrupt load all the files under the directory
&#8220;payloads&#8221; and create the corresponding key.</p>
<dl class="docutils">
<dt>By default, it contains:</dt>
<dd><ul class="first last simple">
<li>xss, a small list of xss payload.</li>
<li>sqli, targeting SQL injection.</li>
<li>cmd, command execution.</li>
<li>default, the compilation of all the above payloads.</li>
</ul>
</dd>
</dl>
</dd></dl>

</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="session.html" title="abrupt.session - Session handler"
             >next</a> |</li>
        <li class="right" >
          <a href="proxy.html" title="abrupt.proxy - HTTP(S) Proxy"
             >previous</a> |</li>
        <li><a href="index.html">Abrupt 0.5 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Securus Global.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>